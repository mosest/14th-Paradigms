import java.io.IOException;
import java.util.Random;

class Model
{
	Bird pigeon;
	Tube green_tube;
	Random rng;
	boolean collision = false;

	Model() throws IOException {
		Bird b = new Bird();
		this.pigeon = b;
		this.green_tube = new Tube(400,100);
		this.rng = new Random();
	}

	public void update() throws IOException {
		pigeon.update();
		green_tube.update(RNG(100, 300), RNG(0, 1));
		collisionDetection();
		if (collision) gameOver();
	}
	
	public void onClick() throws IOException {
		pigeon.flap();
	}
	
	// Returns an int in range [from, to]
	public int RNG(int from, int to) {
		return rng.nextInt(to - from + 1) + from;
	}
	
	public void gameOver() {
		System.out.println("Game over!");
	}
	
	public void collisionDetection() {
		if (green_tube.facing_up) {
			if (pigeon.bird_x + pigeon.bird_width > green_tube.tube_x &&
				pigeon.bird_x < green_tube.tube_x + green_tube.tube_width &&
				pigeon.bird_y + pigeon.bird_height > green_tube.tube_y) {
					collision = true;
				}
		} else {
			if (pigeon.bird_x + pigeon.bird_width > green_tube.tube_x &&
				pigeon.bird_x < green_tube.tube_x + green_tube.tube_width &&
				pigeon.bird_y < green_tube.tube_y) {
					collision = true;
				}
		}
	}
}
